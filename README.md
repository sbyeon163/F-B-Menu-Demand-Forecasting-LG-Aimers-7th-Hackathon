# F&B-Menu-Demand-Forecasting-LG-Aimers-7th-Hackathon

## 🍔 **LG aimers 7기_D&amp;O 곤지암리조트 식음업장 수요예측 온라인 해커톤**
**데이터 희소성(Sparsity) 문제를 극복하기 위한 트리 모델 및 Transformer 기반 앙상블 전략**

**본 프로젝트는 LG AI 연구원에서 주관한 LG Aimers 7기 해커톤의 결과물로, 실제 비즈니스 환경의 데이터 제약 조건을 기술적으로 돌파하여 상위 5%의 성적을 거두었습니다.**

-------------------------------------------------------------------------------------

### 1. 프로젝트 개요

- **주제**: 리조트 내 식음업장별 메뉴 수요 예측(미래 7일)
- **기간**: 2025.07.01~2025.08.25
- **핵심 성과**: 최종 Public Score 0.47573 (상위 5% 이내 달성)


### 2. 핵심 문제 정의
- **희소 데이터(Zero-sales Issue)**: 전체 데이터의 50% 이상이 매출이 발생하지 않는 '0'인 상태로, 일반적인 모델은 이를 단순한 노이즈로 처리하거나 과소 예측하는 경향이 있음.

- **복잡한 외부 변수**: 날씨, 공휴일, 샌드위치 데이 등 다양한 외부 요인이 메뉴 수요에 비선형적인 영향을 미침.


### 3. 주요 분석 전략

- **Step 1. 도메인 기반 피처 엔지니어링**

단순 매출 수치 분석을 넘어 '맥락(Context)'을 부여하기 위해 30여 개의 파생 변수 생성.

- **주요 피처**: '판매 제로 비율(Zero-ratio)', '샌드위치 데이 여부', '공휴일 전후 플래그' 등 매출 발생의 개연성을 설명하는 지표 설계.

**Step 2. 하이브리드 모델 아키텍처 (Ensemble)**

- **Tree 기반 모델 (XGBoost, LightGBM)**: 범주형 데이터 및 통계적 수치 해석에 강점이 있는 트리 모델을 베이스라인으로 설정.

- **CNN-LSTM**: 시간의 흐름(Long-term)과 국소적인 변화 패턴(Short-term)을 동시에 읽어내기 위해 도입.

**Step 3. 기술적 정체 돌파: Transformer(FT-Dozer) 도입**
- 기존 모델들이 변수 간의 복잡한 상관관계를 파악하지 못하는 성능 정체기 발생.

- **해결책**: 어텐션(Attention) 메커니즘을 가진 FT-Dozer 모델 도입. 이를 통해 단순한 수치 변화가 아닌 메뉴-요일-이벤트 간의 **'숨겨진 연관성'**과 **'전체적인 맥락'**을 학습시켜 예측 정확도를 획기적으로 개선.


### 4. 최종 최적화(Late Fusion)

- 검증 데이터(Validation Set)를 기반으로 각 모델의 강점이 발휘되는 가중치를 자동으로 탐색하는 **Late Fusion 전략** 수립.

- 최종 예측값의 하한선을 설정하고 7일간의 **롤링 포캐스트(Rolling Forecast)** 방식을 적용하여 비즈니스 현장에서의 실질적인 활용성을 높임.


### 5. 담당역할 및 기여

**[데이터 전처리 및 피처 엔지니어링]**

- **연회장 특수 데이터 처리**: 일반 식당과 달리 **수요 불균형**이 극심하고 매출 0이 빈번한 연회장 데이터의 특성을 분석하여, 해당 도메인에 최적화된 전처리 로직 구축.

- **파생 변수** 생성: 팀 공동 작업을 주도하며 '이벤트 유무', '계절성 요인', '예약 밀집도' 등 희소 데이터를 보완할 수 있는 30여 개의 도메인 기반 파생 변수를 설계 및 생성.

- **협업 프로세스**: 팀원들과 각자 전처리와 변수 생성을 분담하여 진행한 후, 이를 하나로 통합하는 파이프라인 구축 및 코드 리뷰 수행.

**[모델링 및 실험 최적화]**

- **다각적 모델링 실험**: 베이스라인 모델인 LGBM과 XGBoost를 시작으로, 시계열 특성을 반영한 다양한 알고리즘을 적용하며 예측 성능 비교 실험 주도.

- **하이퍼파라미터 튜닝**: GridSearchCV 및 Optuna 등을 활용하여 각 모델의 파라미터를 최적화하고, 과적합(Overfitting)을 최소화하면서도 예측 정확도를 높이는 최적의 지점을 탐색.

- **실험 기록 및 관리**: 여러 가지 방법론으로 실험한 결과를 수치화하여 기록하고, 팀 내 공유를 통해 최종 앙상블 모델(FT-Dozer 포함) 선정의 근거 마련. 


### 6. 프로젝트 한계점 및 향후 과제 (Post-Mortem)

#### 이슈: Public 대비 Private Score 하락 (과적합 현상 발생)
- **현상**: Public score(데이터의 50%)에서는 우수한 성적(0.47573)을 거두었으나, Private score(전체 데이터 100%) 측정 시 오차가 소폭 상승하는 과적합 양상을 보임.

- **원인 분석**:

    - 리조트 식음업장의 특정 이벤트(공휴일 등) 데이터에 모델이 과도하게 최적화되어, 전체적인 데이터 분포의 변화(Distribution Shift)를 충분히 수용하지 못한 것으로 판단됨.

    - 하이브리드 모델 결합 시 Public 스코어 최적화에 집중한 가중치 설정이 일반화 성능을 저해했을 가능성이 있음.

- **해결 방안 및 발전 방향**:
    1. **교차 검증(Cross-Validation) 강화**: 시계열 특성을 고려한 TimeSeriesSplit 등을 더 엄격하게 적용하여 특정 구간이 아닌 전체 시계열에 대한 일반화 성능 검증 프로세스 구축.

    2. **규제(Regularization) 및 드롭아웃 조정**: Transformer와 트리 모델 내부의 규제 파라미터를 강화하여 모델의 복잡도를 제어하고 과적합 방지.

    3. **데이터 증강(Data Augmentation)**: 희소 데이터 문제를 해결하기 위해 유사 패턴을 가진 가상 데이터를 생성하거나 보간법을 활용하여 모델의 학습 데이터 다양성 확보.


### 기술 스택

- Language: Python

- Library: Pandas, Numpy, matplotlib, seaborn, Scikit-learn, XGBoost, LightGBM, TensorFlow, PyTorch

- Collaboration: GitHub, Notion

